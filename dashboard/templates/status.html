<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cloud Sentinel Status</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/status.css') }}">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>
<body>

<div class="logo-container">
    <img
        src="{{ url_for('static', filename='img/sentinel-logo.png') }}"
        alt="Cloud Sentinel Logo"
        class="main-logo"
    >
</div>

<div class="dashboard">
    <div class="header">
        <span class="title">Cloud Sentinel</span>
    </div>

    <div class="section">
        <div class="section-title collapsible">Backup Summary</div>
        <div class="section-content">
            <ul class="list monospace">
                {% for ev in events %}
                    <li>
                        [ {{ ev.timestamp }} ]
                        {% if "Backup successful" in ev.message %}
                            <span class="success-glow">✅ {{ ev.message }}</span>
                        {% elif "Backup failed" in ev.message %}
                            <span class="error-glow">❌ {{ ev.message }}</span>
                        {% else %}
                            <span class="error-glow">{{ ev.message }}</span>
                        {% endif %}
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <div class="section">
        <div class="section-title collapsible">Last Files Backed Up</div>
        <div class="section-content">
            <ul class="list monospace">
                {% for f in files %}
                    <li>– {{ f }}</li>
                {% endfor %}
            </ul>
        </div>
    </div>

    <div class="section">
        <div class="section-title collapsible">Log Summary</div>
        <div class="section-content">
            <ul class="list monospace">
                <li>– <span style="color: #00ff88;">{{ success_count }} successful backup{{ 's' if success_count != 1 else '' }} today ✅</span></li>
                <li>– <span style="color: #ff5555;">{{ failure_count }} failed backup{{ 's' if failure_count != 1 else '' }} ❌</span></li>
            </ul>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const collapsibles = document.querySelectorAll(".collapsible");
        collapsibles.forEach(title => {
            title.addEventListener("click", function () {
                const content = this.nextElementSibling;
                content.classList.toggle("open");
                this.classList.toggle("active");
            });
        });
    });
</script>
</body>
</html>
